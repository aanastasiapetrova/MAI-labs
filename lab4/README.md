# Л.р. №4. Классификация. Метод к – ближайших соседей (k-NN)
1. Создать симулированный набор данных и записать его на диск в виде csv файла со следующими параметрами:
- продукт;
- сладость;
- хруст;
- класс.

| Product       | Sweetness       | Crunch        |Product Category|
|:-------------: |:---------------:| :-------------:| :-------------:|
| Apple      | 7 |    7 | Fruit |
| Salad     |2 |  5| Vegetable |
| Bacon | 1 |2 | Protein |
| Banana | 9 | 1 | Fruit |
| Nuts | 1 | 5 | Protein |
| Fish | 1 | 1 | Protein |
| Cheese | 1  | 1 | Protein |
| Grape |8 | 1 | Fruit |
| Carrot | 2 | 8 | Vegetable |
| Orange | 6 | 1 | Fruit |

2. Подготовить для классификации несколько примеров.
![](/img/img.png)
3. Запрограммировать метрический классификатор по методу k-NN. Для проверки решить ту же задачу методом k-NN библиотеки sklearn.
4. Прочитать сгенерированный набор данных. Настроить классификатор. Провести эксперимент по классификации с контролем для подготовленных примеров. 
5. По возможности результаты визуализировать.
6. Ввести в набор данных и примеры продукты еще одного класса (возможно изменив набор параметров) и повторить эксперимент.
7. По результатам эксперимента подготовить отчет по лабораторной работе. 

# Отчет по лабораторной работе №4
**Метод k-ближайших соседей (k Nearest Neighbors, или kNN)** – популярный алгоритм классификации, который используется 
в разных типах задач машинного обучения. Наравне с деревом решений это один из самых понятных подходов к классификации.

Интуиция, лежащая в основе алгоритма KNN, является одним из самых простых из всех контролируемых алгоритмов машинного обучения. Он просто вычисляет расстояние от новой точки данных до всех других обучающих точек данных. Расстояние может быть любого типа, например евклидово или манхэттенское и т. Д. Затем он выбирает K-ближайшие точки данных, где K может быть любым целым числом. 
Наконец, он присваивает точку данных классу, к которому принадлежит большинство из K точек данных.

### Плюсы
- Прост в реализации
- Как уже было сказано ранее, это алгоритм ленивого обучения и поэтому не требует обучения перед тем, как делать прогнозы в реальном времени. Это делает алгоритм KNN намного быстрее, чем другие алгоритмы, требующие обучения, например SVM, линейная регрессия и т. Д.
- Поскольку алгоритм не требует обучения перед тем, как делать прогнозы, новые данные могут быть добавлены легко.
- Для реализации KNN требуется только два параметра-значение K и функция расстояния (например, евклидова или манхэттенская и т. Д.)
### Минусы
- Алгоритм KNN плохо работает с данными высокой размерности, потому что при большом количестве измерений алгоритму становится трудно вычислить расстояние в каждом измерении.
- Алгоритм KNN имеет высокую стоимость прогнозирования для больших наборов данных. Это связано с тем, что в больших наборах данных стоимость вычисления расстояния между новой точкой и каждой существующей точкой становится выше.
- Наконец, алгоритм KNN плохо работает с категориальными объектами, так как трудно найти расстояние между измерениями с категориальными объектами.

При выполнении работы качество работы классификаторов было оценено при помощи стандартных метрик классификации:
- **Accuracy** - доля правильных ответов алгоритма
- **Precision** - доля объектов, названных классификатором положительными и при этом действительно являющимися положительными
- **Recall** - доля найденных объектов положительного класса из всех объектов положительного класса
- **F1-score** - среднее гармоническое precision и recall
- **Support** - количество фактических вхождений

При классификации первого набора данных были получены следующие отчеты по классификации:
- Без использования сторонней библиотеки
![](/img/img_1.png)
- При использовании scikit-learn
![](/img/img_2.png)

Оценивая характеристики полученной статистики, сделаем вывод о точности приведенных классификаторов.
Отобразим классифицированные объекты на графиках для оценки правильности классификации:
![](/img/img_3.png)
Приведенные графики совпадают с приведенным в задании графиком распределения.

После исследования первого набора данных, созданного на основе трех категорий продуктов (Fruit, Vegetable, Protein),
было произведено с добавлением новой категории Berry. Выбор категории для добавления был основан на пустующей области графика
распределения из задания, для которой по смыслу была подобрана приведенная категория.

После исследования расширенного набора данных были получены следующие отчеты по классификации:
- Без использования сторонней библиотеки
![](/img/img_5.png)
- При использовании scikit-learn
![](/img/img_4.png)

Оценивая характеристики полученной статистики, сделаем вывод о точности приведенных классификаторов.
Отобразим классифицированные объекты на графиках для оценки правильности классификации:
![](/img/img_6.png)
Приведенные графики совпадают с приведенным в задании графиком распределения, а пустующая область заполнена объектами новой категории.